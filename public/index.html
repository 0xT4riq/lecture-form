<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- اسم التطبيق في iOS -->
  <meta name="apple-mobile-web-app-title" content="تنظيم المحاضرات" />
  <!-- تشغيل كتطبيق مستقل -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- لون الشريط العلوي -->
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <!-- أيقونة مخصصة لـ iOS -->
  <link rel="apple-touch-icon" href="logo.png" />
  <title>عناوين محاضراتي</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="admin-container" class="container">
    <h2>لوحة تحكم الأدمن</h2>
    <button id="admin-logout-btn">تسجيل خروج</button>

    <section>
      <h3>تحميل نسخة احتياطية</h3>
      <button id="downloadBackupBtn">تنزيل النسخة الاحتياطية</button>
    </section>

    <section>
      <h3>رفع نسخة احتياطية</h3>
      <input type="file" id="backupFileInput" accept=".db" />
      <button id="uploadBackupBtn">رفع النسخة</button>
    </section>
    <section>
      <h3>قائمة المستخدمين</h3>
      <table border="1" id="usersTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>الاسم</th>
            <th>البريد</th>
            <th>أدمن؟</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <p id="adminMessage"></p>
  </div>


  <div class="container" id="login-container">
    <h2>تسجيل الدخول</h2>
    <form id="login-form">
      <label>اسم الواعظ</label>
      <input type="text" name="name" required />
      <label>الرقم السري</label>
      <input type="password" name="password" required />
      <button type="submit">دخول</button>
    </form>
    <p>
      ليس لديك حساب؟
      <a href="#" id="show-register">إنشاء حساب</a>
    </p>
    <p>
      <a href="#" id="forgot-password">نسيت كلمة المرور؟</a>
    </p>
    <div id="forgot-password-modal" style="display:none;">
    <h3>إعادة تعيين كلمة المرور</h3>
    <label>البريد الإلكتروني</label>
    <input type="email" id="reset-email" required />
    <button id="send-reset">إرسال</button>
  </div>
  </div>



  <div class="container hidden" id="register-container">
    <h2>إنشاء حساب جديد</h2>
    <form id="register-form">
      <label>اسم الواعظ</label>
      <input type="text" name="name" required />
      <label>البريد الالكتروني</label>
      <input type="text" name="email" required />
      <label>الولاية</label>
      <input type="text" name="state" required />
      <label>الرقم السري</label>
      <input type="password" name="password" required />
      <button type="submit">تسجيل</button>
    </form>
    <p>
      لديك حساب؟
      <a href="#" id="show-login">تسجيل الدخول</a>
    </p>
  </div>

  <div class="container hidden" id="main-container">
    <h2>مرحبًا، <span id="username"></span></h2>
    <button id="logout-btn">تسجيل خروج</button>
    <button id="edit-btn">تحديث البيانات</button> 
    <button id="stats-btn" >إحصائيات</button>
    <h3>إضافة محاضرة جديدة</h3>
    <form id="lecture-form" novalidate>
      <label>النوع</label>
      <select id="type-select" name="type" required>
        <option>محاضرة</option>
        <option>موعظة</option>
        <option>درس</option>
        <option>خطبة</option>
        <option>حضور ورشة</option>
        <option>حضور دورة</option>
        <option>إجازة</option>
        <option value="other">أخرى</option>
      </select>
      <input type="text" id="custom-type" placeholder="اكتب النوع هنا" style="display:none;" />
      
      <!-- Regular lecture fields (hidden for vacation) -->
      <div id="regular-fields">
        <label>العنوان</label>
        <input type="text" name="title" required />

        <label>الولاية</label>
        <input type="text" name="state" autocomplete="on" required />

        <label>المنطقة</label>
        <input type="text" name="area" autocomplete="on" />

        <label>موقع العمل</label>
        <input type="text" name="location" autocomplete="on" />
      </div>

      <!-- Regular date fields (hidden for vacation) -->
      <div id="regular-date-section">
        <label>التاريخ الميلادي</label>
        <input type="date" id="gregorianDate" name="date" required />

        <label>التاريخ الهجري (يُعبأ تلقائياً)</label>
        <input type="text" id="hijriDate" name="hijriDate" readonly />
      </div>

      <!-- Vacation date range fields (hidden by default) -->
      <div id="vacation-date-section" style="display:none;">
        <label>من التاريخ (الميلادي)</label>
        <input type="date" id="vacationDateFrom" name="dateFrom" />

        <label>من التاريخ (الهجري - يُعبأ تلقائياً)</label>
        <input type="text" id="hijriDateFrom" readonly />

        <label>إلى التاريخ (الميلادي)</label>
        <input type="date" id="vacationDateTo" name="dateTo" />

        <label>إلى التاريخ (الهجري - يُعبأ تلقائياً)</label>
        <input type="text" id="hijriDateTo" readonly />
      </div>

      <!-- مكتبات التحويل -->
      <script src="/js/moment.js"></script>
      <script src="/js/moment-hijri.js"></script>

      <!-- Time field (hidden for vacation) -->
      <div id="time-field">
        <label>الوقت</label>
        <select id="time-select" name="time" required>
          <option>بعد صلاة المغرب</option>
          <option>بعد صلاة الفجر</option>
          <option>صباحا</option>
          <option>ظهرا</option>
          <option>بعد صلاة العصر</option>
          <option>مساءا</option>
          <option value="other">أخرى</option>
        </select>
        <input type="text" id="custom-time" placeholder="اكتب التوقيت هنا" style="display:none;" />
      </div>


      <button type="submit">حفظ</button>
    </form>
    <hr />
    <h3>محاضراتي</h3>
    <label>من تاريخ:</label>
    <input type="date" id="date-from" />
    <div id="hijri-from" style="color: gray; font-size: 0.9em; margin-bottom: 10px;"></div>

    <label>إلى تاريخ:</label>
    <input type="date" id="date-to" />
    <div id="hijri-to" style="color: gray; font-size: 0.9em; margin-bottom: 10px;"></div>

    <label>ابحث في المحاضرات:</label>
    <input type="text" id="search" placeholder="ابحث عن اسم المسجد ، الولاية ،التوقيت ..." />
    <button id="search-btn">بحث</button>
    <button id="print-btn">طباعة</button>

    <div id="results"></div>
  </div>
  <div class="container hidden" id="edit-container">
    <h2>تحديث بيانات الحساب</h2>
    <form id="update-form">
        <label>الاسم</label>
        <input type="text" name="name" required />

        <label>البريد الإلكتروني</label>
        <input type="email" name="email" required />

        <label>الولاية</label>
        <input type="text" name="state" required />

        <label>كلمة المرور الجديدة</label>
        <small style="color: gray;">اترك الخانة فارغة إذا لا تريد تغيير كلمة المرور</small>
        <input type="password" name="password" />

        <button type="submit">حفظ التغييرات</button>
    </form>
    <button id="back-btn">رجوع</button>
</div>

<div class="container hidden" id="stats-container">
    <h2>إحصائيات المحاضرات</h2>
    <button id="back-from-stats-btn">رجوع</button>
    <div class="filters">
        <label for="state-filter">الولاية:</label>
        <select id="state-filter">
            <option value="all">جميع الولايات</option>
            </select>

        <label for="type-filter">النوع:</label>
        <select id="type-filter">
            <option value="all">جميع الأنواع</option>
        </select>

        <button id="apply-stats-filter-btn">عرض الإحصائيات</button>
    </div>
        <div id="location-count-display"></div>
    <ul id="location-stats-list">
        </ul>

</div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script src="script.js"></script>

</body>
</html>
